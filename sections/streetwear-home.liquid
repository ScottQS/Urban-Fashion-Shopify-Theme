{% liquid
  assign featured_collection = section.settings.featured_collection
  assign products_limit = section.settings.products_to_show
  assign products_button_url = section.settings.products_button_link
  if products_button_url == blank
    if featured_collection != blank
      assign products_button_url = featured_collection.url
    else
      assign products_button_url = routes.all_products_collection_url
    endif
  endif

  assign hero_button_url = section.settings.hero_button_link
  if hero_button_url == blank
    assign hero_button_url = products_button_url
  endif

  assign hero_background_image = section.settings.hero_image
  if hero_background_image == blank
    assign hero_background_image = section.settings.background_image
  endif
%}

<section
  class="streetwear-home full-width"
  style="--streetwear-accent: {{ section.settings.accent_color }}; --streetwear-panel: {{ section.settings.panel_background }}; --streetwear-overlay-alpha: {{ section.settings.overlay_opacity | divided_by: 100.0 }};"
>
  {% if section.settings.background_image %}
    <div class="streetwear-home__texture" aria-hidden="true">
      {{
        section.settings.background_image
        | image_url: width: 2400
        | image_tag:
          widths: '700,900,1200,1600,2000,2400',
          sizes: '100vw',
          class: 'streetwear-home__texture-image',
          loading: 'lazy'
      }}
    </div>
  {% endif %}

  <div class="streetwear-home__tint" aria-hidden="true"></div>

  <div class="streetwear-home__hero">
    {% if hero_background_image %}
      {{
        hero_background_image
        | image_url: width: 2400
        | image_tag:
          widths: '700,900,1200,1600,2000,2400',
          sizes: '100vw',
          class: 'streetwear-home__hero-bg',
          loading: 'eager'
      }}
    {% endif %}

    <div class="streetwear-home__hero-overlay" aria-hidden="true"></div>

    <div class="streetwear-home__hero-copy">
      {% if section.settings.hero_heading != blank %}
        <h1>{{ section.settings.hero_heading | escape | newline_to_br }}</h1>
      {% endif %}

      {% if section.settings.hero_subheading != blank %}
        <p>{{ section.settings.hero_subheading | escape }}</p>
      {% endif %}

      {% if section.settings.hero_button_label != blank %}
        <a href="{{ hero_button_url }}" class="streetwear-home__button">
          {{ section.settings.hero_button_label | escape }}
        </a>
      {% endif %}
    </div>
  </div>

  <div class="streetwear-home__content">
    <section class="streetwear-home__panel streetwear-home__panel--products">
      {% if section.settings.hero_foreground_image %}
        <div class="streetwear-home__arrivals-figure" aria-hidden="true">
          {{
            section.settings.hero_foreground_image
            | image_url: width: 1600
            | image_tag:
              widths: '420,640,840,1100,1400,1600',
              sizes: '(max-width: 760px) 54vw, 34vw',
              class: 'streetwear-home__arrivals-figure-image',
              loading: 'eager'
          }}
        </div>
      {% endif %}

      <h2>{{ section.settings.products_heading | escape }}</h2>

      <div class="streetwear-home__products">
        {% if featured_collection != blank and featured_collection.products_count > 0 %}
          {% for product in featured_collection.products limit: products_limit %}
            <article class="streetwear-home__product-card">
              <a href="{{ product.url }}" class="streetwear-home__product-image-link">
                {% if section.settings.show_product_badge and section.settings.product_badge_text != blank %}
                  <span class="streetwear-home__badge">{{ section.settings.product_badge_text | escape }}</span>
                {% endif %}

                {% if product.featured_image %}
                  {{
                    product.featured_image
                    | image_url: width: 500, height: 500, crop: 'center'
                    | image_tag:
                      widths: '160,240,320,420,500',
                      sizes: '(max-width: 900px) 24vw, 20vw',
                      class: 'streetwear-home__product-image',
                      loading: 'lazy'
                  }}
                {% else %}
                  {{ 'product-1' | placeholder_svg_tag: 'streetwear-home__placeholder' }}
                {% endif %}
              </a>

              <div class="streetwear-home__product-meta">
                <a href="{{ product.url }}">{{ product.title | escape }}</a>
                <p>{{ product.price | money_with_currency }}</p>
              </div>
            </article>
          {% endfor %}
        {% else %}
          {% for index in (1..8) limit: products_limit %}
            <article class="streetwear-home__product-card">
              <div class="streetwear-home__product-image-link">
                {% if section.settings.show_product_badge and section.settings.product_badge_text != blank %}
                  <span class="streetwear-home__badge">{{ section.settings.product_badge_text | escape }}</span>
                {% endif %}

                {{ 'product-1' | placeholder_svg_tag: 'streetwear-home__placeholder' }}
              </div>

              <div class="streetwear-home__product-meta">
                <p>Sample Product {{ index }}</p>
                <p>{{ 10000 | money_with_currency }}</p>
              </div>
            </article>
          {% endfor %}
        {% endif %}
      </div>

      {% if section.settings.products_button_label != blank %}
        <a href="{{ products_button_url }}" class="streetwear-home__button streetwear-home__button--center">
          {{ section.settings.products_button_label | escape }}
        </a>
      {% endif %}
    </section>

    <section class="streetwear-home__panel streetwear-home__panel--categories">
      <h2>{{ section.settings.categories_heading | escape }}</h2>

      <div class="streetwear-home__categories">
        {% assign has_category_blocks = false %}
        {% for block in section.blocks %}
          {% if block.type == 'category' %}
            {% assign has_category_blocks = true %}
            <a href="{{ block.settings.link | default: routes.collections_url }}" class="streetwear-home__category-card" {{ block.shopify_attributes }}>
              <div class="streetwear-home__category-media">
                {% if block.settings.image %}
                  {{
                    block.settings.image
                    | image_url: width: 720, height: 540, crop: 'center'
                    | image_tag:
                      widths: '180,280,420,560,720',
                      sizes: '(max-width: 900px) 24vw, 22vw',
                      class: 'streetwear-home__category-image',
                      loading: 'lazy'
                  }}
                {% else %}
                  {{ 'collection-1' | placeholder_svg_tag: 'streetwear-home__placeholder' }}
                {% endif %}
              </div>

              <span class="streetwear-home__category-title">{{ block.settings.title | escape }}</span>
            </a>
          {% endif %}
        {% endfor %}

        {% unless has_category_blocks %}
          {% for index in (1..4) %}
            <a href="{{ routes.collections_url }}" class="streetwear-home__category-card">
              <div class="streetwear-home__category-media">
                {{ 'collection-1' | placeholder_svg_tag: 'streetwear-home__placeholder' }}
              </div>
              <span class="streetwear-home__category-title">Category {{ index }}</span>
            </a>
          {% endfor %}
        {% endunless %}
      </div>
    </section>

    <section class="streetwear-home__newsletter">
      <h2>{{ section.settings.newsletter_heading | escape }}</h2>

      {% if section.settings.newsletter_subheading != blank %}
        <p>{{ section.settings.newsletter_subheading | escape }}</p>
      {% endif %}

      {% form 'customer', class: 'streetwear-home__newsletter-form' %}
        <input type="hidden" name="contact[tags]" value="newsletter">
        <label class="streetwear-home__visually-hidden" for="StreetwearEmail-{{ section.id }}">
          {{ section.settings.newsletter_placeholder | escape }}
        </label>
        <input
          id="StreetwearEmail-{{ section.id }}"
          type="email"
          name="contact[email]"
          autocomplete="email"
          placeholder="{{ section.settings.newsletter_placeholder | escape }}"
          required
        >
        <button type="submit">{{ section.settings.newsletter_button_label | escape }}</button>

        {% if form.posted_successfully? %}
          <p class="streetwear-home__form-message">Thanks for signing up. You are on the drop list.</p>
        {% endif %}

        {{ form.errors | default_errors }}
      {% endform %}
    </section>
  </div>
</section>

{% stylesheet %}
  .streetwear-home {
    position: relative;
    isolation: isolate;
    overflow: hidden;
    background: #070910;
    color: #f2f4ff;
    padding-bottom: 2rem;
  }

  .streetwear-home__texture,
  .streetwear-home__tint {
    position: absolute;
    inset: 0;
    pointer-events: none;
  }

  .streetwear-home__texture {
    z-index: -3;
  }

  .streetwear-home__texture-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    filter: brightness(0.36) saturate(0.82);
  }

  .streetwear-home__tint {
    z-index: -2;
    background: linear-gradient(
      to bottom,
      rgba(6, 8, 14, 0.45) 0%,
      rgba(6, 8, 14, 0.84) 38%,
      rgba(6, 8, 14, 0.95) 100%
    );
  }

  .streetwear-home__hero {
    position: relative;
    display: flex;
    align-items: flex-start;
    min-height: clamp(340px, 70vw, 560px);
    padding: clamp(1.3rem, 5vw, 2.35rem) var(--page-margin) clamp(1.2rem, 4vw, 1.9rem);
    border-bottom: 1px solid rgba(255, 255, 255, 0.12);
    overflow: hidden;
  }

  .streetwear-home__hero-bg,
  .streetwear-home__hero-overlay {
    position: absolute;
    inset: 0;
    pointer-events: none;
  }

  .streetwear-home__hero-bg {
    z-index: -2;
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .streetwear-home__hero-overlay {
    z-index: -1;
    background: linear-gradient(
      93deg,
      rgba(5, 7, 12, 0.92) 0%,
      rgba(5, 7, 12, 0.78) 36%,
      rgba(5, 7, 12, var(--streetwear-overlay-alpha)) 60%,
      rgba(5, 7, 12, 0.66) 100%
    );
  }

  .streetwear-home__hero-copy {
    position: relative;
    z-index: 2;
    max-width: min(94vw, 540px);
    padding-top: clamp(0.8rem, 2.6vw, 1.5rem);
    padding-right: 0;
  }

  .streetwear-home__hero-copy h1 {
    margin: 0;
    line-height: 0.89;
    letter-spacing: 0.02em;
    text-transform: uppercase;
    font-size: clamp(2.5rem, 11.6vw, 5.2rem);
    font-weight: 700;
  }

  .streetwear-home__hero-copy p {
    margin-top: 0.7rem;
    max-width: 33ch;
    letter-spacing: 0.115em;
    text-transform: uppercase;
    color: rgba(244, 244, 255, 0.86);
    font-size: clamp(0.88rem, 2.25vw, 1.22rem);
    font-weight: 500;
  }

  .streetwear-home__content {
    display: grid;
    gap: 1.05rem;
    margin: 0 auto;
    width: min(1200px, calc(100% - var(--page-margin) * 2));
    padding-top: 0.9rem;
  }

  .streetwear-home__button {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    margin-top: 1rem;
    min-height: 2.6rem;
    padding: 0.35rem 1.25rem;
    border-radius: 0.2rem;
    border: 1px solid var(--streetwear-accent);
    background: var(--streetwear-accent);
    color: #ffffff;
    text-decoration: none;
    text-transform: uppercase;
    font-size: 0.84rem;
    font-weight: 700;
    letter-spacing: 0.08em;
    transition: transform 120ms ease, filter 120ms ease;
  }

  .streetwear-home__button:hover {
    transform: translateY(-1px);
    filter: brightness(1.08);
  }

  .streetwear-home__button--center {
    margin: 0.9rem auto 0;
    display: flex;
    width: fit-content;
  }

  .streetwear-home__panel {
    border: 1px solid rgba(255, 255, 255, 0.12);
    background: var(--streetwear-panel);
    padding: 0.85rem;
  }

  .streetwear-home__panel--products {
    position: relative;
    isolation: isolate;
    overflow: visible;
  }

  .streetwear-home__arrivals-figure {
    position: absolute;
    top: -3.2rem;
    right: 0;
    z-index: 1;
    width: min(40vw, 410px);
    height: calc(100% + 3.2rem);
    display: flex;
    align-items: flex-start;
    justify-content: flex-end;
    pointer-events: none;
  }

  .streetwear-home__arrivals-figure-image {
    width: 100%;
    max-height: 100%;
    object-fit: contain;
    object-position: top right;
  }

  .streetwear-home__panel--products > h2,
  .streetwear-home__panel--products .streetwear-home__products,
  .streetwear-home__panel--products .streetwear-home__button {
    position: relative;
    z-index: 3;
  }

  .streetwear-home__panel h2,
  .streetwear-home__newsletter h2 {
    margin: 0;
    text-align: center;
    text-transform: uppercase;
    letter-spacing: 0.04em;
    font-size: clamp(1.45rem, 4.1vw, 2.18rem);
  }

  .streetwear-home__products,
  .streetwear-home__categories {
    margin-top: 0.78rem;
    display: grid;
    grid-template-columns: repeat(4, minmax(0, 1fr));
    gap: 0.45rem;
  }

  .streetwear-home__product-card,
  .streetwear-home__category-card {
    border: 1px solid rgba(255, 255, 255, 0.12);
    background: rgba(9, 11, 17, 0.94);
  }

  .streetwear-home__product-image-link {
    position: relative;
    display: block;
    text-decoration: none;
    color: inherit;
    overflow: hidden;
  }

  .streetwear-home__product-image,
  .streetwear-home__placeholder {
    width: 100%;
    aspect-ratio: 1 / 1;
    object-fit: cover;
    background: #0b0f1a;
  }

  .streetwear-home__category-card {
    display: flex;
    flex-direction: column;
    color: inherit;
    text-decoration: none;
  }

  .streetwear-home__category-media {
    overflow: hidden;
  }

  .streetwear-home__category-image {
    width: 100%;
    aspect-ratio: 4 / 3;
    object-fit: cover;
    background: #0b0f1a;
  }

  .streetwear-home__badge {
    position: absolute;
    top: 0.55rem;
    left: 0.55rem;
    z-index: 1;
    border-radius: 999px;
    border: 1px solid rgba(255, 255, 255, 0.35);
    background: rgba(111, 63, 245, 0.85);
    padding: 0.2rem 0.5rem;
    font-size: 0.62rem;
    font-weight: 700;
    letter-spacing: 0.06em;
    text-transform: uppercase;
  }

  .streetwear-home__product-meta {
    display: grid;
    gap: 0.2rem;
    min-height: 4.6rem;
    padding: 0.45rem 0.45rem 0.55rem;
  }

  .streetwear-home__product-meta a,
  .streetwear-home__product-meta p {
    color: inherit;
    font-size: 0.8rem;
    line-height: 1.24;
    text-decoration: none;
  }

  .streetwear-home__product-meta a {
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 2;
    overflow: hidden;
  }

  .streetwear-home__product-meta p:last-child {
    color: rgba(241, 242, 255, 0.86);
    font-size: 0.76rem;
    font-weight: 600;
  }

  .streetwear-home__category-title {
    padding: 0.42rem 0.3rem 0.48rem;
    text-align: center;
    text-transform: uppercase;
    letter-spacing: 0.04em;
    font-size: 0.82rem;
    font-weight: 700;
    background: rgba(8, 10, 15, 0.96);
  }

  .streetwear-home__newsletter {
    text-align: center;
    padding: 0.1rem 0 0.6rem;
  }

  .streetwear-home__newsletter > p {
    margin-top: 0.4rem;
    font-size: 1rem;
    color: rgba(241, 242, 255, 0.84);
  }

  .streetwear-home__newsletter-form {
    margin: 0.95rem auto 0;
    max-width: 520px;
    display: grid;
    grid-template-columns: 1fr auto;
    gap: 0.45rem;
    align-items: center;
  }

  .streetwear-home__newsletter-form input {
    width: 100%;
    min-height: 2.6rem;
    border: 1px solid rgba(255, 255, 255, 0.2);
    background: rgba(255, 255, 255, 0.94);
    color: #0b0f16;
    padding: 0.55rem 0.75rem;
    border-radius: 0.25rem;
  }

  .streetwear-home__newsletter-form .field_with_errors {
    display: block;
  }

  .streetwear-home__newsletter-form .field_with_errors input {
    width: 100%;
  }

  .streetwear-home__newsletter-form button {
    min-height: 2.6rem;
    border: 1px solid var(--streetwear-accent);
    background: var(--streetwear-accent);
    color: #ffffff;
    border-radius: 0.25rem;
    padding: 0.45rem 1rem;
    font-size: 0.82rem;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    font-weight: 700;
    cursor: pointer;
  }

  .streetwear-home__form-message {
    grid-column: 1 / -1;
    font-size: 0.9rem;
  }

  .streetwear-home__visually-hidden {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
  }

  .streetwear-home__newsletter-form .errors {
    grid-column: 1 / -1;
    text-align: left;
    font-size: 0.8rem;
    color: #ffd4d4;
  }

  @media (min-width: 900px) {
    .streetwear-home__hero {
      min-height: 620px;
      padding-top: 2rem;
    }

    .streetwear-home__hero-copy {
      max-width: 620px;
      padding-top: 2.2rem;
    }

    .streetwear-home__arrivals-figure {
      top: -2rem;
      width: min(36vw, 460px);
      height: calc(100% + 2rem);
    }
  }

  @media (max-width: 760px) {
    .streetwear-home__hero {
      min-height: 410px;
    }

    .streetwear-home__hero-copy {
      max-width: min(94vw, 430px);
    }

    .streetwear-home__arrivals-figure {
      top: -20rem;
      right: -0.1rem;
      width: min(64vw, 370px);
      height: calc(100% + 20rem);
    }

    .streetwear-home__panel h2,
    .streetwear-home__newsletter h2 {
      font-size: clamp(1.2rem, 6vw, 1.8rem);
    }
  }

  @media (max-width: 600px) {
    .streetwear-home__arrivals-figure {
      top: -18.2rem;
      width: min(68vw, 350px);
      height: calc(100% + 18.2rem);
    }

    .streetwear-home__newsletter-form {
      grid-template-columns: 1fr;
    }
  }
{% endstylesheet %}

{% schema %}
{
  "name": "Urban homepage",
  "max_blocks": 8,
  "settings": [
    {
      "type": "header",
      "content": "Hero"
    },
    {
      "type": "image_picker",
      "id": "background_image",
      "label": "Background image"
    },
    {
      "type": "image_picker",
      "id": "hero_image",
      "label": "Hero background image"
    },
    {
      "type": "image_picker",
      "id": "hero_foreground_image",
      "label": "Hero foreground image (optional)"
    },
    {
      "type": "textarea",
      "id": "hero_heading",
      "label": "Hero heading",
      "default": "BUILT\nDIFFERENT."
    },
    {
      "type": "text",
      "id": "hero_subheading",
      "label": "Hero subheading",
      "default": "LIMITED STREETWEAR DROPS."
    },
    {
      "type": "text",
      "id": "hero_button_label",
      "label": "Hero button label",
      "default": "Shop now"
    },
    {
      "type": "url",
      "id": "hero_button_link",
      "label": "Hero button link"
    },
    {
      "type": "header",
      "content": "Latest arrivals"
    },
    {
      "type": "collection",
      "id": "featured_collection",
      "label": "Featured collection"
    },
    {
      "type": "text",
      "id": "products_heading",
      "label": "Products heading",
      "default": "Latest arrivals"
    },
    {
      "type": "range",
      "id": "products_to_show",
      "label": "Products to show",
      "min": 2,
      "max": 8,
      "step": 1,
      "default": 4
    },
    {
      "type": "checkbox",
      "id": "show_product_badge",
      "label": "Show product badge",
      "default": true
    },
    {
      "type": "text",
      "id": "product_badge_text",
      "label": "Product badge text",
      "default": "Limited"
    },
    {
      "type": "text",
      "id": "products_button_label",
      "label": "Products button label",
      "default": "Shop now"
    },
    {
      "type": "url",
      "id": "products_button_link",
      "label": "Products button link"
    },
    {
      "type": "header",
      "content": "Categories"
    },
    {
      "type": "text",
      "id": "categories_heading",
      "label": "Categories heading",
      "default": "Shop by category"
    },
    {
      "type": "header",
      "content": "Newsletter"
    },
    {
      "type": "text",
      "id": "newsletter_heading",
      "label": "Newsletter heading",
      "default": "Join the drop list"
    },
    {
      "type": "text",
      "id": "newsletter_subheading",
      "label": "Newsletter subheading",
      "default": "Get exclusive drops and early access to the latest releases."
    },
    {
      "type": "text",
      "id": "newsletter_placeholder",
      "label": "Newsletter placeholder",
      "default": "Enter your email"
    },
    {
      "type": "text",
      "id": "newsletter_button_label",
      "label": "Newsletter button label",
      "default": "Sign up"
    },
    {
      "type": "header",
      "content": "Colors"
    },
    {
      "type": "color",
      "id": "accent_color",
      "label": "Accent color",
      "default": "#6f3ff5"
    },
    {
      "type": "color",
      "id": "panel_background",
      "label": "Panel background",
      "default": "#10131d"
    },
    {
      "type": "range",
      "id": "overlay_opacity",
      "label": "Background overlay opacity",
      "min": 0,
      "max": 90,
      "step": 5,
      "unit": "%",
      "default": 55
    }
  ],
  "blocks": [
    {
      "type": "category",
      "name": "Category tile",
      "settings": [
        {
          "type": "text",
          "id": "title",
          "label": "Title",
          "default": "Category"
        },
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "url",
          "id": "link",
          "label": "Link"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Urban homepage",
      "blocks": [
        {
          "type": "category",
          "settings": {
            "title": "Windbreakers"
          }
        },
        {
          "type": "category",
          "settings": {
            "title": "Pants"
          }
        },
        {
          "type": "category",
          "settings": {
            "title": "Full sets"
          }
        },
        {
          "type": "category",
          "settings": {
            "title": "Hats"
          }
        }
      ]
    }
  ]
}
{% endschema %}
